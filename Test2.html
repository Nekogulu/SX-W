<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>D3 Map</title>
    <style>
      path {
              fill: none;
              stroke: #000;
              stroke-width: .1px;
              stroke-linejoin: round;
              stroke-linecap: round;
            }
    </style>
    <script src="d3/d3.v3.min.js" type="text/javascript"></script>
    <script src="d3/d3-geo-projection.js" type="text/javascript"></script>

  </head>
  <body>
    <script>
            var width = 700,
                height = 700;


            var svg = d3.select("body").append("svg")
                .attr("width", width)
                .attr("height", height);

        var streets =  d3.json("https://raw.githubusercontent.com/Nekogulu/SX-W/master/data/streets.json", function(error, json) {
              if (error) throw error;
              
          });

        var streetsJson = d3.json("https://raw.githubusercontent.com/Nekogulu/SX-W/master/data/streets.json", function(error, json) {
              if (error) throw error;
              else return json;
          });
console.log(streetsJson);
console.log(streets);

           var pump =  d3.json("https://raw.githubusercontent.com/Nekogulu/SX-W/master/data/pump.json");



console.log(pump);

                // create a first guess for the projection
                var center = d3.geo.centroid(streetsJson)
                var scale  = 80;
                var offset = [width/2, height/2];
                var projection = d3.geo.mercator().scale(scale).center(center)
                    .translate(offset);

                // create the path
                var path = d3.geo.path().projection(projection);

                // using the path determine the bounds of the current map and use 
                // these to determine better values for the scale and translation
                var bounds  = path.bounds(streetsJson);
                var hscale  = scale*width  / (bounds[1][0] - bounds[0][0]) -180 ;
                var vscale  = scale*height / (bounds[1][1] - bounds[0][1]) ;
                var scale   = (hscale < vscale) ? hscale : vscale;
                var offset  = [width - (bounds[0][0] + bounds[1][0])/2,
                                    height - (bounds[0][1] + bounds[1][1]  + 200)/2];
                 center1 = center;
                 scale1 = scale;
                 offset1 =  offset;

                // new projection
                projection = d3.geo.mercator().center(center)
                    .scale(scale).translate(offset);
                path = path.projection(projection);
/*
                var points = streetsJson.features.filter(function(d){return d.geometry.type == "Point";});
                var lines = streetsJson.features.filter(function(d){return d.geometry.type == "LineString";});
                var workHouse = streetsJson.features.filter(function(d){return d.properties.name == "WorkHouse";});
                var brewery = streetsJson.features.filter(function(d){return d.properties.name == "Brewery";});

                var pointSvg = svg.append("g")
                                .attr("class", "point");
                var lineSvg = svg.append("g")
                                .attr("class", "lineString");
                var workHosueSvg = svg.append("g")
                                    .attr("class", "workHouse");
                var brewerySvg = svg.append("g")
                                    .attr("class", "brewery");

               pointSvg.selectAll("circle")
                    .data(streetsJsonPoint)
                    .enter()
                    .append("circle")
                    .attr("r", 3)
                    .attr("transform", function(d) {
                             
                            return "translate(" + projection(d.geometry.coordinates) + ")";
                        })
                    .style("fill", "green")
                    .style("stroke-width", "1")
                    .style("stroke", "black")
                    .classed("pin", true);

              lineSvg.selectAll("path")
                    .data(lines)
                    .enter()
                    .append("path")
                    .attr("d", path)
                    .style("stroke-width", "2")
                    .style("stroke", "black");                                
              lineSvg.selectAll("text")
                    .data(json.features)
                    .enter()
                    .append("svg:text")
                    .text(function(d){
                        return d.properties.name;
                    })
                    .attr("x", function(d){
                        return path.centroid(d)[0];
                    })
                    .attr("y", function(d){
                        return  path.centroid(d)[1];
                    })
                    .attr("text-anchor","middle")
                    .attr('font-size','6pt');

              workHosueSvg.selectAll("path")
                    .data(workHouse)
                    .enter()
                    .append("path")
                    .attr("d", path)
                    .style("stroke-width", "1")
                    .style("stroke", "black")
                    .style("fill", "yellow");
              workHosueSvg.selectAll("text")
                    .data(workHouse)
                    .enter()
                    .append("svg:text")
                    .text(function(d){
                        return d.properties.name;
                    })
                    .attr("x", function(d){
                        return path.centroid(d)[0];
                    })
                    .attr("y", function(d){
                        return  path.centroid(d)[1];
                    })
                    .attr("text-anchor","middle")
                    .attr('font-size','6pt');

              brewerySvg.selectAll("path")
                    .data(brewery)
                    .enter()
                    .append("path")
                    .attr("d", path)
                    .style("stroke-width", "1")
                    .style("stroke", "black")
                    .style("fill", "pink");
              brewerySvg.selectAll("text")
                    .data(brewery)
                    .enter()
                    .append("svg:text")
                    .text(function(d){
                        return d.properties.name;
                    })
                    .attr("x", function(d){
                        return path.centroid(d)[0];
                    })
                    .attr("y", function(d){
                        return  path.centroid(d)[1];
                    })
                    .attr("text-anchor","middle")
                    .attr('font-size','6pt');
        
          */      
    
  var pointSvg = svg.append("g")
                                .attr("class", "point");
 pointSvg.selectAll("circle")
                    .data(streetsJsonPoint)
                    .enter()
                    .append("circle")
                    .attr("r", 3)
                    .attr("transform", function(d) {
                             
                            return "translate(" + projection(d.geometry.coordinates) + ")";
                        })
                    .style("fill", "green")
                    .style("stroke-width", "1")
                    .style("stroke", "black")
                    .classed("pin", true);

                    var lineSvg = svg.append("g")
                                .attr("class", "lineString");

                    lineSvg.selectAll("path")
                    .data(streetJsonLine)
                    .enter()
                    .append("path")
                    .attr("d", path)
                    .style("stroke-width", "2")
                    .style("stroke", "black");
 

    </script>
  </body>
</html>